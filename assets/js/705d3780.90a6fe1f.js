"use strict";(self.webpackChunkpulsar_docs=self.webpackChunkpulsar_docs||[]).push([[287],{1197:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>a,toc:()=>c});var r=n(6070),s=n(1503);const i={},o="Authentication",a={id:"Plugins/authentication",title:"Authentication",description:"Authentication is the process of verifying the identity of a user. This is important for securing your server and protecting your data.",source:"@site/docs/05-Plugins/02-authentication.md",sourceDirName:"05-Plugins",slug:"/Plugins/authentication",permalink:"/docs/read/Plugins/authentication",draft:!1,unlisted:!1,editUrl:"https://github.com/pulsar-http/docs/tree/main/docs/05-Plugins/02-authentication.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Rate Limiter",permalink:"/docs/read/Plugins/rate-limiter"},next:{title:"Documentation generation",permalink:"/docs/read/Plugins/documentation-generation"}},u={},c=[{value:"Setup",id:"setup",level:2},{value:"Example",id:"example",level:2},{value:"Route protection",id:"route-protection",level:3},{value:"Summary",id:"summary",level:2}];function h(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"authentication",children:"Authentication"})}),"\n",(0,r.jsx)(t.p,{children:"Authentication is the process of verifying the identity of a user. This is important for securing your server and protecting your data."}),"\n",(0,r.jsx)(t.p,{children:"Pulsar provides a simple way to add authentication to your server using a pre-built middleware."}),"\n",(0,r.jsxs)(t.p,{children:["It uses ",(0,r.jsx)(t.a,{href:"https://authjs.dev",children:"Auth.js"}),"."]}),"\n",(0,r.jsx)(t.h2,{id:"setup",children:"Setup"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["Be sure to set ",(0,r.jsx)(t.code,{children:"AUTH_SECRET"})," in your environment variables."]}),"\n",(0,r.jsxs)(t.li,{children:["The ",(0,r.jsx)(t.code,{children:"AUTH_BASE_PATH"})," environment variable can be used to set the base path for the Auth.js routes. The default is ",(0,r.jsx)(t.code,{children:"/api/auth"}),"."]}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"example",children:"Example"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:'import { start, router, authMiddleware, githubAuthProvider, text, getSession } from "@pulsar-http/core";\n\nconst routes = [\n    router.get("/", async (req) => {\n        const session = await getSession(req);\n        return text(`Hello, ${session?.user?.name ?? \'guest\'}!`);\n    }),\n];\n\nconst auth = authMiddleware({\n    providers: [\n        githubAuthProvider({\n            clientId: "YOUR_CLIENT_ID",\n            clientSecret: "YOUR_CLIENT_SECRET"\n        }),\n    ]\n});\n\nstart({\n    routes,\n    middlewares: [auth],\n});\n'})}),"\n",(0,r.jsx)(t.p,{children:"In this example:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["The ",(0,r.jsx)(t.code,{children:"getSession"})," function is used to get the session data for the current request."]}),"\n",(0,r.jsxs)(t.li,{children:["The ",(0,r.jsx)(t.code,{children:"auth"})," middleware is added to the server, which will handle authentication for the GitHub provider."]}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:"If you access the /api/auth/signin route and sign in with GitHub, the user's name will be displayed on the page."}),"\n",(0,r.jsx)(t.h3,{id:"route-protection",children:"Route protection"}),"\n",(0,r.jsx)(t.p,{children:"You can protect routes by creating a higher-order handler that checks if the user is authenticated."}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:"import { getSession, error, type RouterHandler } from \"@pulsar-http/core\";\n\nexport const withAuth = <Body>(handler: RouterHandler<Body>): RouterHandler<Body> => {\n    return async (...params) => {\n        const session = await getSession(params[0]);\n\n        if (!session?.user) {\n            return error(401, 'You must be logged in to access this resource');\n        }\n\n        return handler(...params);\n    };\n};\n"})}),"\n",(0,r.jsx)(t.p,{children:"You can then use this function to protect routes."}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:'import { start, router, authMiddleware, githubAuthProvider, text, getSession } from "@pulsar-http/core";\nimport { withAuth } from "./wrappers/withAuth";\n\nconst handler = async (req) => {\n    const session = await getSession(req);\n    return text(`Hello, ${session?.user?.name}!`);\n};\n\nconst routes = [\n    router.get("/", withAuth(handler)),\n];\n'})}),"\n",(0,r.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"Authentication is the process of verifying the identity of a user."}),"\n",(0,r.jsxs)(t.li,{children:["Pulsar provides a simple way to use authentication using the ",(0,r.jsx)(t.code,{children:"authMiddleware"})," middleware based on ",(0,r.jsx)(t.a,{href:"https://authjs.dev",children:"Auth.js"}),"."]}),"\n",(0,r.jsxs)(t.li,{children:["You can use the ",(0,r.jsx)(t.code,{children:"getSession"})," function to get the session data for the current request."]}),"\n",(0,r.jsx)(t.li,{children:"There is plenty of providers available, such as GitHub, Google, Facebook, and more."}),"\n"]})]})}function d(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},1503:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>a});var r=n(758);const s={},i=r.createContext(s);function o(e){const t=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),r.createElement(i.Provider,{value:t},e.children)}}}]);